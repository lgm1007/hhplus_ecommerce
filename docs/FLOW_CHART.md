### 플로우 차트
#### 잔액 충전 / 조회
##### 잔액 충전
    1. 클라이언트의 충전 요청
    2. 사용자의 및 충전 금액 확인
    3. 충전 처리 후 성공 응답 반환

```mermaid
flowchart TD
    A[사용자 잔액 충전 요청] --사용자 ID--> B[사용자 잔액 확인]
    B --> C{잔액 조회}
    C --> D[잔액 업데이트]
    D --> E[충전 성공 응답]
```

* **잔액 조회**
    1. 클라이언트의 잔액 조회 요청
    2. 사용자의 잔액 조회 후 반환

```mermaid
flowchart TD
    A[사용자 잔액 조회 요청] --사용자 ID--> B[사용자 잔액 확인]
    B --> C{잔액 조회}
    C --> D[잔액 정보 반환]
```

#### 상품 조회
1. 클라이언트의 상품 조회 요청
2. 상품 목록 및 재고 반환

```mermaid
flowchart TD
    A[상품 조회 요청] --> B[상품 목록 및 재고 정보]
    B --> C[상품 정보 반환]
```

#### 주문 / 결제
##### 주문
1. 클라이언트가 상품을 주문하고 결제 요청 보냄
2. 상품의 재고 확인
3. 주문 정보 저장
4. 장바구니 상품 삭제
5. 재고 차감 이벤트 발행

```mermaid
flowchart TD
    A[상품 주문 요청] --사용자 ID, 상품 ID, 수량--> B[상품 재고 확인]
    B --> C{재고 충분 여부}
    C --충분--> D[주문 정보 저장]
    C --부족--> E[재고 부족 예외]
    D --> F[장바구니 상품 삭제]
    F --> G[상품 재고 차감 이벤트 발행]
```

##### 결제
1. 주문 정보 조회
2. 사용자의 잔액 차감
3. 결제 정보 저장
4. 주문 정보에서 결제 완료로 상태 업데이트
5. 외부 데이터 플랫폼에 전송

```mermaid
flowchart TD
    A[주문 결제 요청] --사용자 ID, 주문 ID--> B[주문 정보 조회]
    B --> C[사용자 잔액 차감 업데이트]
    C --> D[결제 정보 저장]
    D --> E[주문 정보에서 결제 완료 상태로 업데이트]
    E -.-> |비동기 이벤트| F[외부 데이터 플랫폼에 전송]
```

#### 상위 상품 통계
1. 클라이언트가 최근 3일간 가장 많이 팔린 상위 5개의 상품 정보를 요청
2. 통계 데이터에서 상위 5개 상품을 조회하여 반환

```mermaid
flowchart TD
    A[상위 상품 조회 요청] --> B[최근 3일간 결제 완료된 상품 데이터 조회]
    B --> C[판매량 상위 5개 상품 선정]
    C --> D[상위 상품 정보 반환]
```

#### 장바구니 기능
##### 장바구니에 상품 추가
1. 상품의 재고 확인
2. 재고 존재하면 상품 장바구니에 추가

```mermaid
flowchart TD
    A[사용자 장바구니 상품 추가 요청] --사용자 ID, 상품 ID--> B[상품 재고 확인]
    B --> C{재고 충분 여부}
    C --충분--> D[장바구니에 상품 추가]
    C --부족--> E[재고 부족 예외]
```

##### 장바구니 상품 삭제
1. 상품을 장바구니에서 삭제

```mermaid
flowchart TD
    A[사용자 장바구니 상품 삭제 요청] --사용자 ID, 장바구니 ID--> B[장바구니 정보 삭제 요청]
    B --> C[장바구니 삭제 완료 응답]
```

##### 장바구니 조회
1. 현재 장바구니에 담긴 상품 조회

```mermaid
flowchart TD
    A[사용자 장바구니의 상품 조회] --사용자 ID--> B[사용자의 장바구니 정보 조회]
    B --> C[사용자의 장바구니 정보 반환]
```
